<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/estilosGame.css" />
</head>
<body>

<!--
<h1 align="center">Vista Principal</h1>
-->

<div class="row">
  <div class="column left" style="">

    <h3>Click sobre toolbox para ver sus objetos:</h3>

    <div class="gallery1">
        <img id="toolbox" draggable="false" src="Images/tool-box.png" alt="" width="200" height=auto/>
    </div>

    <h3>Click sobre caja para ver objetos recibidos:</h3>

    <div class="gallery1">
        <img id="caja" draggable="false" src="Images/caja.png" alt="" width="200" height=auto/>
    </div>

    <div class="objetos" id="objetosPropios">

      <h3 align="center">
          Objetos Propios
      </h3>

      <p>
          En esta ventana puede ver sus objetos. Entre estos objetos están los 
          <span id="rotuloExperto">"Xol"</span>, que son los cuadrados 
          <span id="tipoPoligono">blancos</span>, cuyas rayas son de color
          <span id="colorRayas">rojo</span>, y tienen
          un número <span id="paridadHorizontales">par</span> de rayas horizontales 
          y un número <span id="paridadVerticales">par</span> de rayas verticales.
          <br>
          <br>
      </p>

        <div class="gallery">
            <img id="drag1" src="Images/objeto1.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag2" src="Images/objeto2.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag3" src="Images/objeto3.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag4" src="Images/objeto4.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag5" src="Images/objeto5.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag6" src="Images/objeto6.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag7" src="Images/objeto7.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag8" src="Images/objeto8.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag9" src="Images/objeto9.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag10" src="Images/objeto10.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag11" src="Images/objeto11.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag12" src="Images/objeto12.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag13" src="Images/objeto13.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag14" src="Images/objeto14.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag15" src="Images/objeto15.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag16" src="Images/objeto16.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag17" src="Images/objeto17.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag18" src="Images/objeto18.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag19" src="Images/objeto19.png" class="Propio"/>
        </div>
        <div class="gallery">
            <img id="drag20" src="Images/objeto20.png" class="Propio"/>
        </div>

        <DIV style="clear:both;" align="center">
          <br>
          Dar dobleclick sobre el objeto para marcarlo
          (dar click para quitar la marca).
          <br>
          <br>
          <br>

          <!--boton de salida-->
          <button class="button1" id='exitButton1'>Salir</button>
        </DIV>
    </div> <!--Cierra div de los objetos propios-->

    <div class="objetos" id="objetosRecibidos">

      <h3 align="center">
          Objetos Recibidos
      </h3>

      <p>
          En esta ventana puede ver los objetos que su compañero
          le ha enviado.
          <br>
          <br>
      </p>

        <div class="gallery">
            <img id="drag1-Recibido" src="Images/objeto1.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag2-Recibido" src="Images/objeto2.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag3-Recibido" src="Images/objeto3.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag4-Recibido" src="Images/objeto4.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag5-Recibido" src="Images/objeto5.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag6-Recibido" src="Images/objeto6.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag7-Recibido" src="Images/objeto7.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag8-Recibido" src="Images/objeto8.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag9-Recibido" src="Images/objeto9.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag10-Recibido" src="Images/objeto10.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag11-Recibido" src="Images/objeto11.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag12-Recibido" src="Images/objeto12.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag13-Recibido" src="Images/objeto13.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag14-Recibido" src="Images/objeto14.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag15-Recibido" src="Images/objeto15.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag16-Recibido" src="Images/objeto16.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag17-Recibido" src="Images/objeto17.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag18-Recibido" src="Images/objeto18.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag19-Recibido" src="Images/objeto19.png" class="Recibido"/>
        </div>
        <div class="gallery">
            <img id="drag20-Recibido" src="Images/objeto20.png" class="Recibido" />
        </div>
        <DIV style="clear:both;" align="center">
          <br>
          Dar dobleclick sobre el objeto para marcarlo
          (dar click para quitar la marca).
          <br>
          <br>
          <br>

          <!--boton de salida-->
          <button class="button1" id='exitButton2'>Salir</button>
        </DIV>
    </div> <!--Cierra div de los objetos recibidos-->


  </div> <!--Cierra div de la columna izquierda-->

  <div class="column middle" style="">
    <h2 align="center">Sus monedas son: <span style="font-size:24pt" id="Puntaje">0 </span> monedas</h2>

    <table style="width:90%">
      <tr>
        <th rowspan="2" >
            <img class="ovalar" src="Images/gears.jpg" draggable="false" align="right" width="200" height="170" alt=""/>
        </th>
        <th align="center" style="width:80%">Arrastre objetos aquí<br> para formar una pareja</th>
      </tr>
      <tr>
        <td>
            <DIV align="center">
              <!--Casillas para arrastrar los objetos-->
                    <div class="droptarget" id = "Izquierdo">
                      <img id="dropIzq" style="display: none;" draggable="false" src="" width="60" height="60"/>
                    </div>

                    <div class="droptarget" id = "Derecho">
                      <img id="dropDer" style="display: none;" draggable="false" src="" width="60" height="60"/>
                    </div>
            </DIV>
          </td>
      </tr>
      <tr>
        <td colspan="2" align="center">
            <br>
            <br>
            <br>
            <button type="button" id="botonVerde">Ingresar pareja a la máquina</button>
        </td>
      </tr>
    </table>

    </div> <!--Cierra div de la columna de en medio-->

  <div class="column right" style="">
    <h2>Hablar con el compañero:</h2>
    <p>Presione el botón para enviar un mensaje a su compañero:</p>
          <button type="button" id='myBtn'>Enviar mensaje</button>

      <h2>Mensajes recibidos:</h2>
      <div class="popup" style="display: none"><span id="notif">Tiene un mensaje nuevo</span></div>
<!--      <h4>Tiene <span id="numMensajes">0</span> mensajes</h4>-->
        <select id=soflow-color>
          <option>Sus mensajes recibidos aquí</option>
        </select>

      <br>
      <br>
      <br>
      <br>

    <div style="float:right">
        <button class="button1" id="finRonda">Finalizar ronda</button>
    </div>


  </div> <!--Cierra div de la columna derecha-->

</div>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class = "modal-content"> 
    <h2>Le han mandado el siguiente mensaje: <span id='Mensaje'></span></h2>
    <HR>
    <h3>Escoja el objeto a enviar:</h3>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag1-Enviar" src="Images/objeto1.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag2-Enviar" src="Images/objeto2.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag3-Enviar" src="Images/objeto3.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag4-Enviar" src="Images/objeto4.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag5-Enviar" src="Images/objeto5.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag6-Enviar" src="Images/objeto6.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag7-Enviar" src="Images/objeto7.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag8-Enviar" src="Images/objeto8.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag9-Enviar" src="Images/objeto9.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag10-Enviar" src="Images/objeto10.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag11-Enviar" src="Images/objeto11.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag12-Enviar" src="Images/objeto12.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag13-Enviar" src="Images/objeto13.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag14-Enviar" src="Images/objeto14.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag15-Enviar" src="Images/objeto5.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag16-Enviar" src="Images/objeto16.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag17-Enviar" src="Images/objeto17.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag18-Enviar" src="Images/objeto18.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag19-Enviar" src="Images/objeto19.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="Enviar" id="drag20-Enviar" src="Images/objeto20.png"/>
        </div>
        <div class="gallery">
            <img type="button" class="" id="botIgn" draggable="false" src="Images/IgnoreButton.png" width="80" height="80"/>
        </div>
  </div>

</div>

<!-- The Modal -->
<div id="myModal2" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
        <div>
          <h2>Escoja su mensaje:</font></h2>
        </div>

            <DIV id = 'Zab' visibility:"visible" z-index:"1">
              <!--imagen del boton ZAB-->
              <button type="button" id='ARRIBAbutton'><span id='arriba'></span></button>
              <br>
              <br>
            </DIV>

            <DIV id = 'Xol' visibility:"visible" z-index:"1">
              <!--imagen del boton XOL-->
              <button type="button" id='MEDIObutton'><span id='medio'></span></button>
              <br>
              <br>
            </DIV>

            <DIV id = 'Dup' visibility:"visible" z-index:"1">
              <!--imagen del boton DUP-->
                <button type="button" id='ABAJObutton'><span id='abajo'></span></button>
            </DIV>

            <div>
                <b><h1 face="arial" aling = "top" ><H4>(Observe que las palabras aparecen de forma aleatoria)</H4></h1></b>
            </div>

            <DIV align="center">
              <!--boton de salida-->
              <button class="button1" id='exitButton'>Salir</button>
            </DIV>


    </div>
</div>

</body>
</html>

<script>

    window.onload = function() {
        
        var node = parent.node;
    
        window.mostrarPopup = function() {
            
            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(6000);
            });
            
        }; // Fin de mostrarPopup

        // Dibuja el puntaje acumulado
        node.events.game.on('Muestra_Popup', window.mostrarPopup); 
        
        /* Events fired on the drag target */
          document.addEventListener("dragstart", function(event) {
              // The dataTransfer.setData() method sets the data type and the value of the dragged data
              event.dataTransfer.setData("Text", event.target.id);

              // Change the opacity of the draggable element
              // event.target.style.opacity = "0.4";
          });

          /* Events fired on the drop target */

          // When the draggable p element enters the droptarget, change the DIVS's border style
          document.addEventListener("dragenter", function(event) {
              if ( event.target.className == "droptarget" ) {
                  event.target.style.border = "3px dotted red";
              }
          });

          // By default, data/elements cannot be dropped in other elements. To allow a drop, we must prevent the default handling of the element
          document.addEventListener("dragover", function(event) {
              event.preventDefault();
          });

          // When the draggable p element leaves the droptarget, reset the DIVS's border style
          document.addEventListener("dragleave", function(event) {
              if ( event.target.className == "droptarget" ) {
                  event.target.style.border = "";
              }
          });

          document.addEventListener("drop", function(event) {
              event.preventDefault();
              if (event.target.className == "droptarget" ) {
                  event.target.style.border = "";
                  var data = event.dataTransfer.getData("Text");
                  console.log('Se enviaron datos', data);
                  console.log('Se arrastro en el', event.target.id);
                  node.emit('Arrastrar', [data, event.target.id]);
              }
          });

          document.addEventListener("click", function(event) {
              event.preventDefault();
              
              // Identifica objeto para enviar al otro jugador
              if (event.target.className == "Enviar" ) {
                  var mensaje_enviar = event.target.id; // Identifica el objeto a enviar
                  var mensaje = mensaje_enviar.substring(0, mensaje_enviar.length - 7);
                  console.log('Se va a enviar el', mensaje);
                  node.emit('Respuesta', [mensaje, mensaje_enviar]); // Envia el id del objeto
              }
              if (event.target.className == "Propio") {
                  event.target.style.border = "";
                  var enviados = event.target.id + '-Enviar';
                  document.getElementById(enviados).border = "";
              }
              if (event.target.className == "Recibido") {
                  event.target.style.border = "";
              }
          });

          document.addEventListener("dblclick", function(event) {
              event.preventDefault();
              console.log('Se está marcando', event.target.id);
              if (event.target.className == "Recibido") {
                  event.target.style.border = "1px solid red";
                  node.emit('Marcacion', [event.target.id, false]);
              }
              if (event.target.className == "Propio") {
                  event.target.style.border = "1px solid red";
                  var enviados = event.target.id + '-Enviar';
                  document.getElementById(enviados).border = "1px solid red";
                  node.emit('Marcacion', [event.target.id, true]);
              }
          });

    } // end onload function

</script>
