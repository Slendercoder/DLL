<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/estilosGame.css" />
<style>
  #container{
    width: 1300px;
    height: 300px;
    margin: 0 auto;
    padding-top: 20px;
    padding-bottom: 50px;
  }
</style>
</head>
<body>
    <div style="overflow: auto">
      <div id="container">
        <div id="solicitudAbierta" class="modal">
            <div class="modal-content" align="center">
            <h2>Su compañero dice: <span id="Solicitud"></span>?</h2>
                <button class="button1" id='correcto'>Correcto</button>
                <button class="button1" id='incorrecto'>Incorrecto</button>
                <button class="button1" id='nose'>No sé</button>  
            </div>           
        </div>  

    <div id="enviarSolicitud" class="modal">
        <div class="modal-content" align="center">
<!--            <span class="close">&times;</span> -->
            <h3>Preguntar a su compañero: "¿este perro es...?" <span id="Solicitud"></span></h3>
                <button class="button1" id='botonA'>A</button>
                <button class="button1" id='botonB'>B</button>             
                <button class="button1" id='botonC'>C</button>
                <button class="button1" id='botonD'>D</button>
        </div>           
    </div> 

    <div id="confirmarRonda" class="modal1">
        <div class="modal-content" align="center">
            <h2>¿Está seguro de que desea terminar la ronda?</h2>
                <button class="button1" id='salir'>Sí</button>
                <button class="button1" id='quedar'>No</button>             
        </div>           
    </div>  
          
    <div id="companero" class="modal1">
        <div class="modal-content" align="center">
            <h2>Su compañero ha confirmado. Ya no podrá enviar ni recibir mensajes en esta ronda</h2>
                <button class="button1" id='partnerdone'>OK</button>            
        </div>           
    </div>  
    <div id="Tutorial2" class="modal1" style="display: block">
        <div class="modal-content" align="center" style="padding-bottom: 15px; font-size: 13pt">
            <h2>Tutorial 2/2</h2>
            Bienvenido al tutorial de las rondas de <i>juego</i>. Al igual que en el entrenamiento, usted tendrá que clasificar los cinco perros en la pantalla, pero ahora dispondrá de <b>cuatro</b> categorías de clasificación: las dos en las que usted se entrenó más las dos de su compañero. 
            <br><br>
            Adicionalmente, verá dos elementos nuevos en su pantalla: el menú de mensajes y el signo de interrogación <img src="questionmark.png" style="width: 15px">. Durante el juego, usted podrá utilizar estos elementos para interactuar con su compañero. En este tutorial se enseñan los componentes de la interacción.
            <br><br>
            Por favor preste atención al cuadro de instrucciones en la parte inferior izquierda de su pantalla para avanzar en el tutorial. <br><br> 
            <b> Nota: los perros que verá en este tutorial no serán los que clasificará durante el experimento. </b>
            <br><br><br>
                <button class="button1" id="cerrarTut2">OK</button>             
        </div> 
    </div>
          
      <h1 align="center" id=mensaje>Clasifique todos los perros:</h1>
        <div class="gallery">
         <div class="pop1" style="display: none"><span id="confirm1"></span><span id="popdog1"></span></div>

          <img id="Perro1" src="" style="draggable: false">
          <div class="desc">
           <select text-align="center" id="select1">
            <option value="Nada">Elija una opción</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
           </select>
         </div>
      </div>

      <div class="gallery">
        <div class="pop2" style="display: none"><span id="confirm2"></span><span id="popdog2"></span></div>
         <img id="Perro2" src="">
         <div class="desc">
          <select text-align="center" id="select2">
            <option value="Nada">Elija una opción</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
         </div>
      </div>

      <div class="gallery">
        <div class="pop3" style="display: none"><span id="confirm3"></span><span id="popdog3"></span></div>
         <img id="Perro3" src="">
         <div class="desc">
          <select text-align="center" id="select3">
            <option value="Nada">Elija una opción</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
         </div>
      </div>

      <div class="gallery">
        <div class="pop4" style="display: none"><span id="confirm4"></span><span id="popdog4"></span></div>
         <img id="Perro4" src="">
         <div class="desc">
          <select text-align="center" id="select4">
            <option value="Nada">Elija una opción</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
         </div>
      </div>

      <div class="gallery">
        <div class="pop5" style="display: none"><span id="confirm5"></span><span id="popdog5"></span></div>
         <img id="Perro5" src="">
         <div class="desc">
          <select text-align="center" id= "select5">            
            <option value="Nada">Elija una opción</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
         </div>
      </div>
    </div>


    <div class="column left" style="padding-top: 0px">
        <div id="MenuMensajes" style="padding-left: 140px">
      <h3 style="padding-left: 25px;">Solicitudes pendientes:</h3>
      <div class="popup" style="display: none"><span id="notif"></span></div>
      <select id=soflow-color >
          <option id ="numSol">Tiene 0 mensajes sin leer</option>
      </select>
        </div>
        <div id="cuadroinst" style="border: 5px solid Turquoise; display: block; text-align: center; font-size: 14pt">
            <p><span id="inst">Arrastre algún perro hasta el signo de interrogación.</span><span id="conteo"></span></p>
        </div>
        <div id="dummy" style="display: none"></div>
    </div>
    
    <div class="column middle" style="padding-left: 150px; padding-top: 50px;">
    	
     

    </div>
    
    
    <div class="column right" style="">
    
    <div style="padding-left: 0px; padding-bottom: 120px; padding-top: 0px; margin-left: auto; margin-right: auto; text-align: center; font-size: 14pt">
        <p style="font-size: 13px"><b>Arrastre aquí una imagen para enviarle un mensaje a su compañero</b></p>
        <div style="padding-left: 90px">
            <div id = "botonComunicacion" align=center style="padding-bottom: 80px">           
                <img class="droptarget" src="questionmark.png" alt="interrogacion" id="botonSolicitud" width="150px" height="150px">
            </div>            
        </div> 
    </div>

        
      <div id = "confirmar" align="right" style="padding-top: 20px; text-align: center; display: none">
         <p style="font-size: 13px"><b>Presione aquí para confirmar su clasificación y terminar la ronda</b></p><br> 
      </div>
        <div style="text-align: center">
            <button class="button" id='continuar' style="top:-10px; align: right; display: none">Confirmar</button>
        </div>
      
      
        
    </div>
    </div>
</body>
</html>

<script>

    window.onload = function() {
        
        var node = parent.node;

        window.mostrarPopup = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(6000);
            });

        }; // Fin de mostrarPopup
        
        
        window.mostrarP1 = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".pop1").delay(2000);
                          $(".pop1").slideDown(500);
                          $(".pop1").fadeOut(6000);
                          $(".popup").delay(7000);
                          node.emit('cambio', '1');
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(3000);
                          
            });

        }; // Fin de mostrarPopup
        
        
        window.mostrarP2 = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".pop2").delay(2000);
                          $(".pop2").slideDown(500);
                          $(".pop2").fadeOut(6000);
                          $(".popup").delay(7000);
                          node.emit('cambio', '1');
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(3000);
            });

        }; // Fin de mostrarPopup
        
        
        window.mostrarP3 = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".pop3").delay(2000);
                          $(".pop3").slideDown(500);
                          $(".pop3").fadeOut(6000);
                          $(".popup").delay(7000);
                          node.emit('cambio', '1');
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(3000);
            });

        }; // Fin de mostrarPopup
        
        window.mostrarP4 = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".pop4").delay(2000);
                          $(".pop4").slideDown(500);
                          $(".pop4").fadeOut(6000);
                          $(".popup").delay(7000);
                          node.emit('cambio', '1');
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(3000);
            });
            };

        
        window.mostrarP5 = function() {

            console.log('Mostrando popup!');

            $(document).ready(function(){
                          $(".pop5").delay(2000);
                          $(".pop5").slideDown(500);
                          $(".pop5").fadeOut(6000);
                          $(".popup").delay(7000);
                          node.emit('cambio', '1');
                          $(".popup").slideDown(500);
                          $(".popup").fadeOut(3000);
            });

        }; // Fin de mostrarPopup

        // Muestra el popup
        node.events.game.on('Muestra_Popup', window.mostrarPopup); 

        node.events.game.on('Muestra_Pop1', window.mostrarP1); 
        
        node.events.game.on('Muestra_Pop2', window.mostrarP2); 
        
        node.events.game.on('Muestra_Pop3', window.mostrarP3); 
        
        node.events.game.on('Muestra_Pop4', window.mostrarP4); 
        
        node.events.game.on('Muestra_Pop5', window.mostrarP5); 

        /* Events fired on the drag target */

        // LISTENER DRAG 


        document.addEventListener("dragstart", function(event) {
            // The dataTransfer.setData() method sets the data type and the value of the dragged data
            event.dataTransfer.setData("Text", event.target.id);

            // Change the opacity of the draggable element
            // event.target.style.opacity = "0.4";
        });

        /* Events fired on the drop target */


        // When the draggable p element enters the droptarget, change the DIVS's border style
        document.addEventListener("dragenter", function(event) {
            if ( event.target.className == "droptarget" ) { 
                if ( document.getElementById('enviarSolicitud').style.display == "none" && document.getElementById('dummy').style.display == "none"){
                    event.target.style.border = "3px dotted red";
                }                
            }
        }); 

        // By default, data/elements cannot be dropped in other elements. To allow a drop, we must prevent the default handling of the element
        document.addEventListener("dragover", function(event) {
          event.preventDefault();
        });

        
        
        // When the draggable p element leaves the droptarget, reset the DIVS's border style
        document.addEventListener("dragleave", function(event) {
          if ( event.target.className == "droptarget" ) {
              event.target.style.border = "";
          }
        }); 


        // LISTENER DROP

        document.addEventListener("drop", function(event) {
          event.preventDefault();
          if (event.target.className == "droptarget" ) {
              event.target.style.border = "";
              var data = event.dataTransfer.getData("Text");
              console.log('Se enviaron datos', data);
              console.log('Se arrastro en el', event.target.id);
              node.emit('Arrastrar', [data, event.target.className]);
          }
        });

        
        // LISTENERS BOTONES

        document.addEventListener("click", function(event) {
          event.preventDefault();

          if (event.target.className == "close" ) {
              node.emit('Solicitud', 'cerrar');    
          }
          if (event.target.className == "button1"){
              if(event.target.id == "partnerdone"){
                  node.emit('Solicitud', 'bloquear');
              }
              if(event.target.id == "botonA"){
                  node.emit('Solicitud', 'A');
              }
              if(event.target.id == "botonB"){
                  node.emit('Solicitud', 'B');
              }
              if(event.target.id == "botonC"){
                  node.emit('Solicitud', 'C');
              }
              if(event.target.id == "botonD"){
                  node.emit('Solicitud', 'D');
              }
              if(event.target.id == "correcto"){
                  node.emit('Solicitud', 'Correcto');
              }
              if(event.target.id == "incorrecto"){
                  node.emit('Solicitud', 'Incorrecto');
              }
              if(event.target.id == "nose"){
                  node.emit('Solicitud', 'nose');
              }
              if(event.target.id == "cerrarTut2"){
                  node.emit('Solicitud', 'cerrarTut2');
              }
              if(event.target.id == "salir"){
                  node.emit('Solicitud', 'terminar');
              }if(event.target.id == "quedar"){
                  node.emit('Solicitud', 'continuar');    
              }               
          }    
        }); 

    } // end onload function

</script>
